@model IEnumerable<ApexDrive.Models.Payment>
@{
    ViewData["Title"] = "Payments Management";
    Layout = "~/Areas/Admin/Views/Shared/_Layout.cshtml";
}

<h1 class="text-2xl font-bold text-brand mb-6">💳 Payments Management</h1>

<!-- 🔍 Filter Bar -->
<form method="get" class="mb-6 bg-white p-4 rounded-xl shadow flex flex-wrap gap-4 items-end">
    <div>
        <label class="block text-sm font-semibold mb-1 text-gray-700">Search</label>
        <input type="text" name="search" value="@ViewBag.Search" placeholder="Booking ID or Email"
               class="rounded-lg border-gray-300 px-3 py-2 w-56 focus:ring-primary-500" />
    </div>

    <div>
        <label class="block text-sm font-semibold mb-1 text-gray-700">Status</label>
        <select name="status" class="rounded-lg border-gray-300 px-3 py-2 focus:ring-primary-500">
            <option value="All">All</option>
            <option value="Pending" selected="@(ViewBag.Status == "Pending")">Pending</option>
            <option value="Paid" selected="@(ViewBag.Status == "Paid")">Paid</option>
        </select>
    </div>

    <div>
        <label class="block text-sm font-semibold mb-1 text-gray-700">From</label>
        <input type="date" name="fromDate" value="@ViewBag.FromDate"
               class="rounded-lg border-gray-300 px-3 py-2 focus:ring-primary-500" />
    </div>

    <div>
        <label class="block text-sm font-semibold mb-1 text-gray-700">To</label>
        <input type="date" name="toDate" value="@ViewBag.ToDate"
               class="rounded-lg border-gray-300 px-3 py-2 focus:ring-primary-500" />
    </div>

    <div class="flex items-end">
        <button type="submit"
                class="px-6 py-2 bg-blue-600 text-white rounded-lg font-semibold hover:bg-blue-700">
            🔍 Filter
        </button>
    </div>
</form>

<!-- 💳 Payments Table -->
<div class="bg-white shadow rounded-xl overflow-hidden">
    <table class="min-w-full text-sm text-gray-700">
        <thead class="bg-gray-100 text-gray-800 font-semibold">
            <tr>
                <th class="px-4 py-3 text-left">Booking ID</th>
                <th class="px-4 py-3 text-left">Customer</th>
                <th class="px-4 py-3 text-left">Method</th>
                <th class="px-4 py-3 text-left">Status</th>
                <th class="px-4 py-3 text-left">Amount</th>
                <th class="px-4 py-3 text-left">Created</th>
                <th class="px-4 py-3 text-right">Action</th>
            </tr>
        </thead>
        <tbody>
            @if (!Model.Any())
            {
                <tr><td colspan="7" class="text-center py-6 text-gray-500">No records found.</td></tr>
            }
            else
            {
                foreach (var item in Model)
                {
                    var badge = item.Status == "Paid"
                    ? "bg-green-100 text-green-700"
                    : "bg-yellow-100 text-yellow-700";

                    <tr class="border-t hover:bg-gray-50">
                        <td class="px-4 py-3 font-medium">@item.Booking?.BookingId</td>
                        <td class="px-4 py-3">@item.Booking?.Customer?.Email</td>
                        <td class="px-4 py-3">@item.Method</td>
                        <td class="px-4 py-3">
                            <span class="px-2 py-1 rounded-full text-xs font-semibold @badge">@item.Status</span>
                        </td>
                        <td class="px-4 py-3 font-semibold">@item.Amount.ToString("C")</td>
                        <td class="px-4 py-3">@item.CreatedAt.ToString("dd MMM yyyy")</td>
                        <td class="px-4 py-3 text-right">
                            <a asp-action="Edit" asp-route-id="@item.PaymentId"
                               class="text-blue-600 hover:text-blue-800 font-medium">Edit</a>
                        </td>
                    </tr>
                }
            }
        </tbody>
    </table>
</div>
